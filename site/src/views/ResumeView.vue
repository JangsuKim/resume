<template>
  <div class="min-h-screen bg-gray-100 py-10 px-4">
    <!-- ìŠ¤ì¼€ì¼ëŸ¬ ë˜í¼: ì¹´ë“œ ì „ì²´(ë‚´ìš© í¬í•¨)ë¥¼ ê·¸ë£¹ìœ¼ë¡œ ìŠ¤ì¼€ì¼ -->
    <div
      class="mx-auto select-none"
      :style="{ width: (BASE_WIDTH * effectiveScale) + 'px' }"
      @dblclick.prevent="toggleMode"
      @touchend.passive="onTouchEnd"
    >
      <!-- A4 ì¹´ë“œ: ê³ ì • í­, ì‹œê°ë§Œ scale -->
      <div
        class="relative bg-white border border-gray-300 shadow-sm rounded-md p-10 print-scale"
        style="width: 820px;"
        :style="{
          transform: `scale(${effectiveScale})`,
          transformOrigin: 'top left'
        }"
      >

        <!-- ìƒë‹¨ íƒ€ì´í‹€ + ì–‡ì€ ì„  -->
        <header class="text-center mb-8">
          <h1 class="text-3xl font-extrabold tracking-wider">RESUME</h1>
          <div class="mt-3 h-px bg-neutral-400"></div>
        </header>

        <!-- í”„ë¡œí•„ ë°•ìŠ¤ (ë‚´ìš© ê·¸ëŒ€ë¡œ) -->
        <section>
          <div
            class="w-full"
            style="display:grid; grid-template-columns: 1fr 200px; gap:4px;"
          >
            <!-- ì¢Œ: ì´ë¦„ + ì •ë³´í‘œ (í…ìŠ¤íŠ¸) -->
            <div class="pl-12">
              <h2 class="text-[30px] leading-[1.05] font-semibold mb-3">
                KIM JANGSU
                <span class="text-[20px] text-gray-600 font-normal ml-2">(ã‚­ãƒ ãƒ»ã‚¸ãƒ£ãƒ³ã‚¹)</span>
              </h2>

              <table class="w-full text-[15px] leading-[1.35]">
                <tbody>
                  <tr class="align-top">
                    <td class="w-[72px] text-gray-500 pb-2">age</td>
                    <td class="pb-2">40æ­³ (1985-08-19)</td>
                  </tr>
                  <tr class="align-top">
                    <td class="w-[72px] text-gray-500 pb-2">e-mail</td>
                    <td class="pb-2">
                      <a href="mailto:jangsoo719@gmail.com" class="hover:underline">jangsoo719@gmail.com</a>
                    </td>
                  </tr>
                  <tr class="align-top">
                    <td class="text-gray-500 pb-2">mobile</td>
                    <td class="pb-2">080-3733-6561</td>
                  </tr>
                  <tr class="align-top">
                    <td class="text-gray-500 pb-2">address</td>
                    <td class="pb-2">å¤§é˜ªåºœå¤§é˜ªå¸‚æ±æˆåŒºä¸­æœ¬5-13-10</td>
                  </tr>
                  <tr class="align-top">
                    <td class="text-gray-500">Web</td>
                    <td>
                      <a href="https://github.com/JangsuKim" target="_blank" class="hover:underline">ğŸ§‘â€ğŸ’» [GitHub]</a>
                    </td>
                  </tr>
                </tbody>
              </table>
            </div>

            <!-- ìš°: ì‚¬ì§„ (ì¡°ê¸ˆ ë” ì™¼ìª½ìœ¼ë¡œ ë‹¹ê¹€) -->
            <div class="flex justify-start items-start pr-10 relative right-10">
              <img
                src="@/assets/profile.jpg"
                alt="í”„ë¡œí•„"
                class="w-[150px] h-[190px] object-cover rounded-sm border border-gray-200 mr-auto translate-x-2"
              />
            </div>
          </div>
        </section>

        <!-- íƒ€ì„ë¼ì¸ -->
        <section class="mt-4 pt-2">
          <ResumeTimeline />
        </section>

        <!-- è³‡æ ¼ãƒ»èªå®š : ê³ ì • 2ì»¬ëŸ¼ ê·¸ë¦¬ë“œ -->
        <section class="mt-8 border-t border-gray-200 pt-3 pl-8">
          <div style="display:grid; grid-template-columns: 110px 1fr; column-gap:18px;">
            <div class="flex items-start">
              <h3 class="font-semibold text-lg">å…è¨±ãƒ»è³‡æ ¼</h3>
            </div>
            <div>
              <div class="space-y-2 text-[15px] leading-[1.5]">
                <div style="display:grid; grid-template-columns: 1fr 450px;">
                  <span>JLPT 2ç´š</span>
                  <span class="text-neutral-600 text-left">(2009å¹´2æœˆ)</span>
                </div>
                <div style="display:grid; grid-template-columns: 1fr 450px;">
                  <span>TOEIC 750ç‚¹</span>
                  <span class="text-neutral-600 text-left">(2023å¹´2æœˆ)</span>
                </div>
                <div style="display:grid; grid-template-columns: 1fr 450px;">
                  <span>æƒ…å ±å‡¦ç†ç”£æ¥­æ£‹å£«</span>
                  <span class="text-neutral-600 text-left">(2016å¹´11æœˆ)</span>
                </div>
              </div>
            </div>
          </div>
        </section>

        <!-- ë§í¬ -->
        <section class="mt-8 border-t border-gray-200 pt-3 pl-7 relative z-10">
          <div class="flex items-start gap-6">
            <h3 class="font-semibold text-lg">è·å‹™çµŒæ­´æ›¸</h3>
            <RouterLink
              :to="{ name: 'CareerPage' }"
              class="inline-flex items-center gap-2 text-blue-600 hover:text-gray-900 transition-colors pl-6"
            >
              è·å‹™çµŒæ­´æ›¸ã¸ç§»å‹• <span aria-hidden="true">â†’</span>
            </RouterLink>
          </div>
        </section>

      </div>
    </div>
  </div>
</template>

<script setup lang="ts">
import { ref, computed, onMounted, onBeforeUnmount } from 'vue'
import ResumeTimeline from '@/components/ResumeTimeline.vue'

const BASE_WIDTH = 820      // ì¹´ë“œ ì„¤ê³„ í­(px)
const OUTER_PADDING = 32    // í˜ì´ì§€ ì¢Œìš° padding(px-4 = 16*2)

type Mode = 'fit' | 'actual'   // fit=í™”ë©´í­ ë§ì¶¤, actual=100%
const mode = ref<Mode>('fit')

const fitScale = ref(1)     // ìë™ ìŠ¤ì¼€ì¼
const scale = ref(1)        // actual ëª¨ë“œ ìˆ˜ë™ ìŠ¤ì¼€ì¼(í•„ìš” ì‹œ í™•ì¥ ê°€ëŠ¥)
const effectiveScale = computed(() => (mode.value === 'fit' ? fitScale.value : scale.value))

function computeFit() {
  const vw = window.innerWidth
  const available = Math.max(0, vw - OUTER_PADDING)
  fitScale.value = Math.min(1, available / BASE_WIDTH)
}

function toggleMode() {
  if (mode.value === 'fit') {
    mode.value = 'actual'
    scale.value = Math.min(1, Math.max(0.5, fitScale.value)) // fit ê°’ì„ ì‹œì‘ì ìœ¼ë¡œ
  } else {
    mode.value = 'fit'
  }
}

// ëª¨ë°”ì¼ ë”ë¸”íƒ­ ê°ì§€ (Fit â†” 100%)
let lastTouch = 0
function onTouchEnd(e: TouchEvent) {
  const now = Date.now()
  if (now - lastTouch < 300) {
    toggleMode()
    e.preventDefault()
  }
  lastTouch = now
}

onMounted(() => {
  computeFit()
  window.addEventListener('resize', computeFit, { passive: true })
})
onBeforeUnmount(() => {
  window.removeEventListener('resize', computeFit)
})
</script>

<style>
  @media print {
    body {
      -webkit-print-color-adjust: exact;
      print-color-adjust: exact;
    }

    /* A4ì— ë§ì¶° ìë™ ì¶•ì†Œ */
    .print-scale {
      transform: scale(0.72);
      transform-origin: top center;
    }
  }
</style>